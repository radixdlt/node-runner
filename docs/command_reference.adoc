:sectnums:
=== Core node or Gateway setup using docker
Below are the list of commands that can be used with cli to setup a core node or gateway.

==== radixnode docker dependencies
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode docker dependencies [-h]

This commands installs all necessary software on the Virtual Machine(VM). Run
this command on fresh VM or on a existing VM as the command is tested to be
idempotent

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode docker config
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode docker config [-h] [-t TRUSTEDNODE] [-d CONFIGDIR]
                               [-n NETWORKID] [-p POSTGRESPASSWORD]
                               [-k KEYSTOREPASSWORD] [-nk] [-xc {true,false}]
                               [-xg {true,false}] -m {CORE,GATEWAY,DETAILED}
                               [{CORE,GATEWAY,DETAILED} ...] [-a]

This commands allows node-runners and gateway admins to create a config file,
which can persist their custom settings. Thus it allows is to decouple the
updates from configuration. Config is created only once as such and if there
is a version change in the config file, then it updated by doing a migration
to newer version

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -m {CORE,GATEWAY,DETAILED} [{CORE,GATEWAY,DETAILED} ...], --setupmode {CORE,GATEWAY,DETAILED} [{CORE,GATEWAY,DETAILED} ...]
                        Quick config mode with assumed defaults. It supports
                        two quick modes and a detailed config mode. CORE: Use
                        this value to setup CORE using defaults. GATEWAY: Use
                        this value to setup GATEWAY using defaults. DETAILED:
                        Default value if not provided. This mode takes your
                        through series of questions.

optional arguments:
  -t TRUSTEDNODE, --trustednode TRUSTEDNODE
                        Trusted node on radix network.Example format: 'radix:/
                        /rn1qthu8yn06k75dnwpkysyl8smtwn0v4xy29auzjlcrw7vgduxvn
                        wnst6derj@54.216.99.177'.This is required only if you
                        are creating config to run a CORE node and if not
                        provided you will be prompted to enter a value
  -d CONFIGDIR, --configdir CONFIGDIR
                        Path to node-config directory where config file will
                        stored. Default value is /Users/shambu/node-config
  -n NETWORKID, --networkid NETWORKID
                        Network id of network you want to connect.For stokenet
                        it is 2 and for mainnet it is 1.If not provided you
                        will be prompted to enter a value
  -p POSTGRESPASSWORD, --postgrespassword POSTGRESPASSWORD
                        Network Gateway uses Postgres as datastore. This is
                        password for the user `postgres`.
  -k KEYSTOREPASSWORD, --keystorepassword KEYSTOREPASSWORD
                        Core Node requires a keystore. This is the password
                        for the keystore file the CLI will create new key with
                        name `node-keystore.ks` in config directory. If the
                        keystore exists in config directory, CLI finds it ,
                        and uses the password from -k parameter or prompt for
                        the password to be entered. CLI never modifies the
                        password of keystore
  -nk, --newkeystore    Set this to true to create a new store without any
                        prompts using location defined in argument configdir
  -xc {true,false}, --disablenginxforcore {true,false}
                        Core Node API's are protected by Basic auth
                        setting.Set this to disable to nginx for core
  -xg {true,false}, --disablenginxforgateway {true,false}
                        GateWay API's end points are protected by Basic auth
                        settings. Set this to disable to nginx for gateway
  -a, --autoapprove     Set this to true to run without any prompts and in
                        mode CORE or GATEWAY.Prompts still appear if you run
                        in DETAILED mode Use this for automation purpose only
----

==== radixnode docker install
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode docker install [-h] [-f CONFIGFILE] [-a] [-u]

This commands setups up the software and deploys it based on what is stored in
the config.yaml file. To update software versions, most of the time it is
required to update the versions in config file and run this command

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -f CONFIGFILE, --configfile CONFIGFILE
                        Path to config file. This file is generated by running
                        'radixnode docker config'The default value is
                        `/Users/shambu/node-config/config.yaml` if not
                        provided
  -a, --autoapprove     Pass this option to run without any prompts. Use this
                        for automation purpose only
  -u, --update          Pass this option to update the deployed softwares to
                        latest version. CLI prompts to confirm the versions if
                        '-a' is not passed
----

==== radixnode docker start
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode docker start [-h] [-f CONFIGFILE]

This commands starts the docker containers based on what is stored in the
config.yaml file. If you have modified the config file, it is advised to use
setup command.

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -f CONFIGFILE, --configfile CONFIGFILE
                        Path to config file. This file is generated by running
                        'radixnode docker config'The default value is
                        `/Users/shambu/node-config/config.yaml` if not
                        provided
----

==== radixnode docker stop
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode docker stop [-h] [-f CONFIGFILE] [-v]

This commands stops the docker containers

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -f CONFIGFILE, --configfile CONFIGFILE
                        Path to config file. This file is generated by running
                        'radixnode docker config'The default value is
                        `/Users/shambu/node-config/config.yaml` if not
                        provided
  -v, --removevolumes   Remove the volumes
----
=== Radix node CLI command reference
Below are the list of commands supported in cli to setup a core node process as a systemd process

==== radixnode systemd dependencies
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode systemd dependencies [-h]

This commands installs all necessary software on the Virtual Machine(VM). Run
this command on fresh VM or on a existing VM as the command is tested to be
idempotent

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode systemd install
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode systemd install [-h] [-r RELEASE] [-x NGINXRELEASE] -t
                                 TRUSTEDNODE -n {fullnode,archivenode} -i
                                 HOSTIP [-ts] [-u]

This sets up the systemd service for the core node.

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -t TRUSTEDNODE, --trustednode TRUSTEDNODE
                        Trusted node on radix network
  -n {fullnode,archivenode}, --nodetype {fullnode,archivenode}
                        Type of node fullnode or archivenode
  -i HOSTIP, --hostip HOSTIP
                        Static Public IP of the node

optional arguments:
  -r RELEASE, --release RELEASE
                        Version of node software to install
  -x NGINXRELEASE, --nginxrelease NGINXRELEASE
                        Version of radixdlt nginx release
  -ts, --enabletransactions
                        Enable transaction stream api
  -u, --update          Update the node to new version of node
----

==== radixnode systemd restart
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode systemd restart [-h] [-s {all,nginx,radixdlt-node}]

This restarts the CORE node systemd service.

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -s {all,nginx,radixdlt-node}, --services {all,nginx,radixdlt-node}
                        Name of the service either to be started. Valid values
                        nginx or radixdlt-node
----

==== radixnode systemd stop
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode systemd stop [-h] [-s {all,nginx,radixdlt-node}]

This stops the CORE node systemd service.

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -s {all,nginx,radixdlt-node}, --services {all,nginx,radixdlt-node}
                        Name of the service either to be stopped. Valid values
                        nginx or radixdlt-node
----
=== Set passwords for the Nginx server
This will set up the admin user and password for access to the general system endpoints.

==== radixnode auth set-admin-password
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode auth set-admin-password [-h] -m {DOCKER,SYSTEMD}
                                         [-u USERNAME] [-p PASSWORD]

This sets up admin password on nginx basic auth. Refer this link for all the
paths. https://docs.radixdlt.com/main/node-and-gateway/port-
reference.html#_endpoint_usage

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -m {DOCKER,SYSTEMD}, --setupmode {DOCKER,SYSTEMD}
                        Setup type whether it is DOCKER or SYSTEMD

optional arguments:
  -u USERNAME, --username USERNAME
                        Name of admin user. Default value is `admin`
  -p PASSWORD, --password PASSWORD
                        Password of admin user
----

==== radixnode auth set-superadmin-password
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode auth set-superadmin-password [-h] -m {DOCKER,SYSTEMD}
                                              [-u USERNAME] [-p PASSWORD]

This sets up superadmin password on nginx basic auth. Refer this link for all
the paths. https://docs.radixdlt.com/main/node-and-gateway/port-
reference.html#_endpoint_usage

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -m {DOCKER,SYSTEMD}, --setupmode {DOCKER,SYSTEMD}
                        Setup type whether it is DOCKER or SYSTEMD

optional arguments:
  -u USERNAME, --username USERNAME
                        Name of superadmin user. Default value is `superadmin`
  -p PASSWORD, --password PASSWORD
                        Password of superadmin user
----

==== radixnode auth set-metrics-password
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode auth set-metrics-password [-h] -m {DOCKER,SYSTEMD}
                                           [-u USERNAME] [-p PASSWORD]

This sets up metrics password on nginx basic auth. Refer this link for all the
paths. https://docs.radixdlt.com/main/node-and-gateway/port-
reference.html#_endpoint_usage

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -m {DOCKER,SYSTEMD}, --setupmode {DOCKER,SYSTEMD}
                        Setup type whether it is DOCKER or SYSTEMD

optional arguments:
  -u USERNAME, --username USERNAME
                        Name of metrics user. Default value is `metrics`
  -p PASSWORD, --password PASSWORD
                        Password of metrics user
----

==== radixnode auth set-gateway-password
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode auth set-gateway-password [-h] -m {DOCKER,SYSTEMD}
                                           [-u USERNAME] [-p PASSWORD]

This sets up gateway password on nginx basic auth. Refer this link for all the
paths. https://docs.radixdlt.com/main/node-and-gateway/port-
reference.html#_endpoint_usage

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -m {DOCKER,SYSTEMD}, --setupmode {DOCKER,SYSTEMD}
                        Setup type whether it is DOCKER or SYSTEMD

optional arguments:
  -u USERNAME, --username USERNAME
                        Name of gateway user. Default value is `gateway`
  -p PASSWORD, --password PASSWORD
                        Password of gateway user
----
=== Accessing core endpoints using CLI
Once the nginx basic auth passwords for admin, superadmin, metrics users are setup , radixnode cli can be used to access the node endpoints

==== radixnode core entity
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core entity [-h] [-v] [-a] [-p] [-sy] [-ss] [-su] [-se]

This command helps to retrieve information about an entity. CAUTION - Running
these commands on any node will slow down your node. If you are running a
validator, it may miss proposals. The command will prompt for you to continue
or not. For automation purpose, you can suppress the prompt exporting env
variable named SUPPRESS_API_COMMAND_WARN=true

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -v, --validator       Display entity details of validator address
  -a, --address         Display entity details of validator account address
  -p, --p2p             Display entity details of validator peer to peer
                        address
  -sy, --subEntitySystem
                        Display entity details of validator address along with
                        sub entity system
  -ss, --subPreparedStake
                        Display entity details of validator account address
                        along with sub entity prepared_stake
  -su, --subPreparedUnStake
                        Display entity details of validator account address
                        along with sub entity prepared_unstake
  -se, --subExitingStake
                        Display entity details of validator account address
                        along with sub entity exiting_stake
----

==== radixnode core key-list
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core key-list [-h]

This command helps to list the details of the validator keystore on a running
node using node's CORE API

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode core mempool
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core mempool [-h]

This command helps to fetch transactions in mempool

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode core mempool-transaction
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core mempool-transaction [-h] -t TRANSACTIONID

This command helps to fetch transaction in mempool of the node by transaction
Id

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -t TRANSACTIONID, --transactionId TRANSACTIONID
                        transaction Id to be searched on mempool
----

==== radixnode core update-validator-config
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core update-validator-config [-h]

Utility command that helps a node runner to 'register ' or 'unregister' or
'set validator metadata such as name/url' or 'Add or change validator fee' or
'Setup delegation or change owner id' or 'Prompt for voting if ready for
forking'

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode core signal-protocol-update-readiness
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core signal-protocol-update-readiness [-h]

This command helps to signal readiness for forking if there is voting required

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode core retract-protocol-update-readiness
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api core retract-protocol-update-readiness [-h]

This command helps to withdraw from voting for the fork

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode system metrics
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api system metrics [-h]

This command helps to list the metrics that are exposed from the metrics
endpoint of the node

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode system health
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api system health [-h]

This command displays the health of the node on whether it is syncing, or
booting or up

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode system version
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode api system version [-h]

This command displays the version of node software that is currently running

optional arguments:
  -h, --help  show this help message and exit
----
=== Setup monitoring using CLI
Using CLI , one can setup monitoring of the node or gateway.

==== radixnode monitoring config
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode monitoring config [-h]
                                   [-m {MONITOR_CORE,MONITOR_GATEWAY,DETAILED} [{MONITOR_CORE,MONITOR_GATEWAY,DETAILED} ...]]
                                   [-cm COREMETRICSPASSWORD]
                                   [-gm GATEWAYAPIMETRICSPASSWORD]
                                   [-am AGGREGATORMETRICSPASSWORD]
                                   [-d MONITORINGCONFIGDIR]

This commands allows to create a config file, which can persist custom
settings for monitoring. Thus it allows is to decouple the updates from
configuration. Config is created only once as such and if there is a version
change in the config file, then it updated by doing a migration to newer
version

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -m {MONITOR_CORE,MONITOR_GATEWAY,DETAILED} [{MONITOR_CORE,MONITOR_GATEWAY,DETAILED} ...], --setupmode {MONITOR_CORE,MONITOR_GATEWAY,DETAILED} [{MONITOR_CORE,MONITOR_GATEWAY,DETAILED} ...]
                        Quick setup with assumed defaults. It supports three
                        quick setup mode and a detailed setup mode.
                        MONITOR_CORE: Use this value to monitor Core using
                        defaults which assume core is run on same machine as
                        monitoring. MONITOR_GATEWAY: Use this value to monitor
                        GATEWAY using defaults which assume network gateway is
                        run on same machine. DETAILED: Default value if not
                        provided. This mode takes your through series of
                        questions.
  -cm COREMETRICSPASSWORD, --coremetricspassword COREMETRICSPASSWORD
                        Password for core metrics basic auth user
  -gm GATEWAYAPIMETRICSPASSWORD, --gatewayapimetricspassword GATEWAYAPIMETRICSPASSWORD
                        Password for gateway api metrics basic auth user
  -am AGGREGATORMETRICSPASSWORD, --aggregatormetricspassword AGGREGATORMETRICSPASSWORD
                        Password for aggregator metrics basic auth user
  -d MONITORINGCONFIGDIR, --monitoringconfigdir MONITORINGCONFIGDIR
                        Path to monitoring directory where config file will
                        stored
----

==== radixnode monitoring install
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode monitoring install [-h] [-f MONITORINGCONFIGFILE] [-a]

This commands setups up the software and deploys it based on what is stored in
the config.yaml file. To update software versions, most of the time it is
required to update the versions in config file and run this command

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -f MONITORINGCONFIGFILE, --monitoringconfigfile MONITORINGCONFIGFILE
                        Path to config file. Default is
                        '/Users/shambu/monitoring/monitoring_config.yaml'
  -a, --autoapprove     Set this to true to run without any prompts
----

==== radixnode monitoring start
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode monitoring start [-h] [-f MONITORINGCONFIGFILE] [-a]

This commands starts the docker containers based on what is stored in the
config.yaml file. If you have modified the config file, it is advised to use
setup command.

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -f MONITORINGCONFIGFILE, --monitoringconfigfile MONITORINGCONFIGFILE
                        Path to config file. Default is
                        '/Users/shambu/monitoring/monitoring_config.yaml'
  -a, --autoapprove     Set this to true to run without any prompts
----

==== radixnode monitoring stop
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode monitoring stop [-h] [-f MONITORINGCONFIGFILE] [-v]

This commands stops the docker containers

optional arguments:
  -h, --help            show this help message and exit

optional arguments:
  -f MONITORINGCONFIGFILE, --monitoringconfigfile MONITORINGCONFIGFILE
                        Path to config file. Default is
                        '/Users/shambu/monitoring/monitoring_config.yaml'
  -v, --removevolumes   Remove the volumes
----
=== CLI helper commands to interact with keystore
Using CLI, for a key file, you can print out the validator address. This feature is in beta and currently only below commands supported.

==== radixnode key info
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode key info [-h] -p PASSWORD -f FILELOCATION

Using CLI, for a key file, you can print out the validator address. This
feature is in beta.

optional arguments:
  -h, --help            show this help message and exit

required arguments:
  -p PASSWORD, --password PASSWORD
                        Password of the keystore
  -f FILELOCATION, --filelocation FILELOCATION
                        Location of keystore on the disk
----
=== Other commands supported by CLI
List of other commands supported by cli are to check the version of CLI being used and optimise-node
to setup some of the OS tweaks on ubuntu

==== radixnode version 
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode.py version [-h]

Run this command td display the version of CLI been used.

optional arguments:
  -h, --help  show this help message and exit
----

==== radixnode optimise-node 
[source, bash,subs="+quotes, +attributes" ]
----
usage: radixnode.py optimise-node [-h]

Run this command to setup ulimits and swap size on the fresh ubuntu machine .
Prompts asking to setup limits . Prompts asking to setup swap and size of swap
in GB

optional arguments:
  -h, --help  show this help message and exit
----
